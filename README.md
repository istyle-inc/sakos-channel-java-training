Java課題は本リポジトリで行う。  
本リポジトリはメンテナンス中以外はアーカイブされているため、読み取り専用として扱うこと。

# 0. 準備

VSCode上での開発を想定。
Extension Pack for javaの利用を推奨。(そのうち設定ファイルに追加予定)

1. コンテナ外での操作
   1. リポジトリをクローンする。
   1. リポジトリルートに移動してコンソールを開き、docker-compose up でjava環境を起動する。
   1. VSCodeのremote explorerで↑で起動したコンテナに接続する
      * ディレクトリはusr/project/appディレクトリを選択する
1. コンテナ内での操作(appディレクトリ)
   1. コンソールからgradle buildコマンドを実行する (npm iや composer installのようなつもりで)
   1. プロダクトコードはsrc/main/java以下、テストコードはsrc/test/java以下に配置される。
   1. gradle run testコマンドを実行する (これでテストが実行できる)

---

# 1. bookパッケージ: 本をしまうなら……

初期状態ではbookパッケージのBookAppで処理を行っている。  
改善に当たってはプロダクト/テスト双方とも、bookパッケージ内部全体を改修してよいので  
こころおきなく手腕を振るわれたい。   
ただし、テストの既存ケースはそのまま残すこと。

## シチュエーション1 重複なく本を確保したい

`BookApp#シチュエーション1_本のリストに重複なく本を足したい` メソッドがテーマ  
このメソッド自体は一応目的を達成しているが、  
不満点が山とある状態からスタート

- 複雑度が高すぎるし見通しが悪すぎる
- BookApp以降、本リストに重複がないことの保証は都度行う必要がある
- 状態依存が大きく、何か他の条件等を追加するときの改修が非常にやりにくい

---

# 2. dateパッケージ: 「日付」

## シチュエーション1 日付、と、日付……？
あるサービスにおいて、日付文字列を取得するためのAPIが一つ定義されている。  
※ここでのAPIはコントローラを模したアプリケーションクラス DateApi とする。

- 現時点での実日時を返却するAPI
  - ISO8061拡張形式(秒まで)の文字列で返却する
    - 例: 1985-10-26T01:35:00

ここに、次の新しいAPIを追加したい。

- 現在の営業日付、および現在営業中であるかを返却するAPI
  - 例: 1985年10月25日 / false


APIの定義はスタブとして用意されたものを利用して、実装を付与してみよう。

### 仕様に関して

- 日付の扱いについてはOffsetDateTimeとAsia/Tokyoのタイムゾーンを利用する。(改修前実装参照)
  - 実プロダクトでは詳細に考慮すること
  - 参考: https://qiita.com/dmikurube/items/15899ec9de643e91497c
- このサービスの実日時では、日付の秒数を「切り捨て」て扱うことになっている。
  - 1985-10-26T01:35:01 -> 実日時 1985-10-26T01:35:00
- 「営業日時」について
  - 実日時と異なり、秒数は「繰り上げ」て処理することになっている。
  - 実日時と異なり、午前4時を境に日付が変わり、それまでは前日の扱いとなる。
    - (どうやら午前0時から実行される日次集計バッチの終了を待っているらしい……)
    - 例: 実時間が 1985-10-26T01:34:01 の場合、営業日時分は 1985年10月25日01時35分 となる。
  - このサービスにおいて、営業時間は 09:00 ～ 18:00 としている。
- このAPIにはまともなUTがない。このタイミングで実装するべきだろう。
  - まずはテスト可能性を付与する必要がありそうだ。

### ヒント
- どうやらDateTimeをそのまま引っ張りまわすのは筋が悪そう
- Composition over inheritance
- 実日時と営業日時には、できれば互換性を持たせたい
